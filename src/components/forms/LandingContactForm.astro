---
import {Icon} from 'astro-icon/components'
import { Button, FormInput } from '@components/odyssey-theme';

const selectOptions = [
  "Google Search",
  "Social Media",
  "Email",
]

---

<form name="Contact Form" method="POST" action="/contact-thank-you" >
  <FormInput type="text" label="First Name" name="First Name" placeholder="John" />
  <FormInput type="text" label="Last Name" name="Last Name" placeholder="Doe" />
  <FormInput type="email" label="Email" name="Email" placeholder="hello@example.com" />
  <Button customIcon>Submit
    <Fragment slot="icon">
      <Icon name="ic:baseline-chevron-right" />
    </Fragment>
  </Button>
</form>

<style>
  form {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
  }
</style>

---
import { Button } from '@components/odyssey-theme.js';
---

<form id="landingContactForm" name="Landing Page Form" method="POST">
  <input type="hidden" name="formType" value="landing" />
  <div class="form-group">
    <label for="firstName">First Name</label>
    <input type="text" name="firstName" id="firstName" placeholder="John" required />
  </div>
  <div class="form-group">
    <label for="lastName">Last Name</label>
    <input type="text" name="lastName" id="lastName" placeholder="Doe" required />
  </div>
  <div class="form-group">
    <label for="email">Email</label>
    <input type="email" name="email" id="email" placeholder="hello@example.com" required />
  </div>
  <div class="form-group">
    <label for="phone">Phone</label>
    <input type="tel" name="phone" id="phone" placeholder="(702) 555-1234" />
  </div>
  <div class="form-group">
    <label for="message">Message</label>
    <textarea name="message" id="message" placeholder="Your message here..." cols="30" rows="4"></textarea>
  </div>
  <Button id="landingSubmitBtn">Submit</Button>
  <div id="landingFormStatus" class="form-status"></div>
</form>

<script>
  import { sendToFollowUpBoss, formatContactFormData } from '../../utils/followUpBoss.js';

  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('landingContactForm');
    const formStatus = document.getElementById('landingFormStatus');

    if (form) {
      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        try {
          const formData = new FormData(form);
          const formDataObj = {};

          for (const [key, value] of formData.entries()) {
            formDataObj[key] = value;
          }

          // Add landing page source
          formDataObj.source = 'Landing Page Form';

          formStatus.textContent = 'Sending your information...';
          formStatus.className = 'form-status sending';

          const leadData = formatContactFormData(formDataObj);
          // Add landing page specific tag
          leadData.tags.push('landing-page');

          await sendToFollowUpBoss(leadData);

          formStatus.textContent = 'Thank you! Your message has been sent.';
          formStatus.className = 'form-status success';
          form.reset();

          // Redirect after 2 seconds
          setTimeout(() => {
            window.location.href = '/contact-thank-you';
          }, 2000);

        } catch (error) {
          console.error('Form submission error:', error);
          formStatus.textContent = 'There was an error sending your message. Please try again.';
          formStatus.className = 'form-status error';
        }
      });
    }
  });
</script>

<style>
  form {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
  }

  .form-group {
    display: flex;
    flex-direction: column;
  }

  label {
    font-weight: bold;
    font-size: var(--font-size-sm);
    margin-bottom: 0.5rem;
  }

  input, textarea, select {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 2px solid var(--neutral-600);
    border-radius: 0.25rem;
    font-size: var(--font-size-md);
  }

  input::placeholder, textarea::placeholder, select::placeholder {
    color: var(--neutral-500);
  }

  input:focus, textarea:focus, select:focus {
    border-color: var(--primary-300);
    outline: none;
  }

  .form-status {
    margin-top: 1rem;
    padding: 0.75rem;
    border-radius: 0.25rem;
    font-weight: bold;
    text-align: center;
  }

  .sending {
    background-color: #f0f0f0;
    color: #666;
  }

  .success {
    background-color: #e6f7e6;
    color: #2c662d;
  }

  .error {
    background-color: #ffecec;
    color: #cc0033;
  }
</style>